window.jsdapi=window.jsdapi||{};
(function(f){function g(b){var a=jsdapi.url();b&&(a+="/"+b);return a}function h(b){var a=jsdapi.url()+"/account";b&&(a+="/"+b);return a}function e(b){if(b)try{b.apply(this,[].slice.call(arguments).splice(1))}catch(a){console.error(a)}}f.me=function(b){jsdapi.authorize(function(a){a?(a={responseType:"json",method:"GET",url:g("openid/me"),query:{access_token:a,ignoreGrantsGiven:!0,ignoreGrantsGivenBy:!0,ignoreProducts:!0,ignoreTags:!0}},jsdapi.http.sendRequest(a,function(a){if(!a||a.error)return e(b,
a||{error:500});var c={checksum:a.me.checksum,name:a.me.name};a.me.email&&(c.email=a.me.email);if(a.me.accounts)try{var d=JSON.parse(a.me.accounts);0<d.length&&(c.account=d[0],c.account.username&&(c.username=c.account.username),c.account.provider&&(c.provider=c.account.provider))}catch(k){console.error(k)}if(!c.account)return e(b,{error:500});delete c.account;e(b,c)})):e(b,{error:401,message:"Authorization failed!"})})};f.applyActivationCode=function(b,a){jsdapi.authorize(function(d){if(d){var c=
JSON.stringify(b);d={responseType:"json",method:"POST",url:h("applyActivationCode"),query:{access_token:d},contentType:"application/json",content:c};jsdapi.http.sendRequest(d,function(b){e(a,b)})}else e(a,{error:401,message:"Authorization failed!"})})}})(window.jsdapi.account=window.jsdapi.account||{});
