Logger.initialize();var RUNTIME={LoadingReasons:{Clean:"clean",Timeout:"timeout"},loadingReason:localStorage.__runtime_loading_reason||"clean",loadingLastTimeout:void 0===localStorage.__runtime_loading_lastTimeout?0:parseInt(localStorage.__runtime_loading_lastTimeout),loadingNextTimeout:3E4,loadingTimeoutIncrement:3E4,loadingTimeoutOccurred:function(){localStorage.__runtime_loading_reason=RUNTIME.LoadingReasons.Timeout;localStorage.__runtime_loading_lastTimeout=RUNTIME.loadingNextTimeout;window.location.reload()}};
localStorage.__runtime_loading_reason="clean";localStorage.__runtime_loading_lastTimeout=0;RUNTIME.loadingReason===RUNTIME.LoadingReasons.Timeout?3E5<=RUNTIME.loadingLastTimeout+RUNTIME.loadingTimeoutIncrement&&(RUNTIME.loadingLastTimeout=3E5-RUNTIME.loadingTimeoutIncrement):RUNTIME.loadingLastTimeout=3E4;RUNTIME.loadingNextTimeout=RUNTIME.loadingLastTimeout+RUNTIME.loadingTimeoutIncrement;Logger.instance.log('"'+chrome.runtime.getManifest().name+'" ('+chrome.runtime.id+"). Loading reason: ",RUNTIME.loadingReason);
function documentReady(){CWEBackgroundManager.initialize()}document.onreadystatechange=function(){"complete"===document.readyState&&documentReady()};chrome.webNavigation.onDOMContentLoaded.addListener(function(a){0!==a.frameId&&0!==a.url.indexOf("about:")&&chrome.tabs.executeScript(a.tabId,{file:"ContentScripts/cweFramePreloader.js",frameId:a.frameId,runAt:"document_end"},CWEChromeUtilities.createLastErrorHandler())});
chrome.runtime.onMessage.addListener(function(a,b,c){"com.donjohnston.cowriter.service.load"===a.message&&"ms-office-word-editor"===a.service&&executeScripts(b.tab.id,b.frameId,"document_end",["Common/cweLogger.js","Common/cweChromeCoreCharacterSet.js","Common/cweChromeUtilities.js","Common/messageProxy.js","ContentScripts/cweOffice365WordProxy.js"])});
function executeScripts(a,b,c,d,e){var f=-1,g=function(){CWEChromeUtilities.checkLastError();d.length<=++f?e&&e():chrome.tabs.executeScript(a,{file:d[f],frameId:b,runAt:c},g)};g()};
